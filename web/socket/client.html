<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<title>Joomla Platform - socket example</title>
		</head>
		<script src="../media/system/js/mootools-core.js"></script>  
		<script type="text/javascript" src="client.js"></script>
		<script>
		/* window.addEvent('load', function() {
			sconn = new SocketConnector(document.id('log'));
		}); */
		var socket;
		 
		function init() {
			var host = "ws://127.0.0.1:8080/examples/socket/server.php";
			try {
				socket = new WebSocket(host);
				socket.onopen = function(msg){ };
				socket.onmessage = function(msg){
					console.log(msg);
					data = JSON.decode(msg.data.replace("\0", ''));
					/* for (userId in data) {
						if (data[userId].position) {
							var pos = data[userId].position.split(',');
							var color = data[userId].color;
							render(userId, pos[0], pos[1], color);
						}
					} */
				};
				socket.onclose = function(msg){ };
			} catch(ex){ console.log(ex); }
		 
		
		}
		 
		function render(u, x, y, c) {
		}
		 
		function ssend(x,y) {
			var msg = x + ',' + y;
			socket.send(msg);
		}
		</script>
	<body id="body" onload="init()">
		
		<h1>Socket example on the Joomla Platform</h1>
		
		<button id="send" onclick="ssend(1,2);">Ping</button>
		
		<textarea id="log" style="width:100%; height: 200px"></textarea>

	</body>
</html>